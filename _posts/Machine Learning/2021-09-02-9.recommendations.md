---
title: "9.Recommendations"
excerpt: "추천 시스템"
toc: true
toc_label: "Recommendations"
toc_sticky: true

categories:
  - Machine Learning
tags:
  - 추천 시스템
  - 파이썬 머신러닝 완벽 가이드
last_modified_at: 2021-09-03
---

>![파이썬 머신러닝 완벽 가이드](https://user-images.githubusercontent.com/76269316/122906446-1fa9c000-d38d-11eb-9cab-1eb7e347a1e6.png)
>
>파이썬 머신러닝 완벽 가이드를 읽고 공부한 내용을 정리한 포스팅입니다.

### 추천 시스템의 개요와 배경

##### 추천 시스템의 개요

하나의 콘텐츠를 선택했을 때 선택된 콘텐츠와 연관된 추천 콘텐츠가 얼마나 사용자의 관심을 끌고 개인에게 맞춤 콘텐츠를 추천했는지는 그 사이트의 평판을 좌우하는 매우 중요한 요소입니다.

추천 시스템의 진정한 묘미는 사용자 자신도 좋아하는지 몰랐던 취향을 시스템이 발견하고 그에 맞는 콘텐츠를 추천해주는 것입니다.

이러한 추천 시스템을 접한 사용자는 해당 사이트를 더 강하게 신뢰하게 되어 더 많은 추천 콘텐츠를 선택하게 되고, 결국 더 많은 데이터가 축적되면서 추천 시스템이 더욱 정확해지고 다양한 결과를 얻을 수 있는 선순환 시스템을 구축할 수 있게 됩니다.

넷플릭스, 유튜브, 아마존 등 많은 기업들이 사용자의 관심을 오랫동안 지속하기 위해 추천 시스템의 고도화에 큰 비용과 투자를 아끼지 않고 있습니다.

<br><br>

##### 온라인 스토어의 필수 요소, 추천 시스템

온라인 스토어는 많은 양과 고객의 상품 관련 데이터를 갖고 있는데, 너무 많은 상품과 콘텐츠는 오히려 사용자가 어떤 상품을 골라야 할지에 대한 압박감을 느끼게 만듧니다.

이때 좋은 추천 시스템은 사용자가 무엇을 원하는지 빠르게 찾아내 사용자의 온라인 쇼핑을 도와 이러한 상황을 타개해줍니다.

온라인 스토어는 많은 양의 고객과 상품 관련 데이터를 갖고 있는데, 다음과 같은 데이터가 추천 시스템을 구성하는데 사용될 수 있습니다.

- 사용자가 어떤 상품을 구매했는가?
- 사용자가 어떤 상품을 둘러보거나 장바구니에 넣었는가?
- 사용자가 평가한 영화 평점은? 제품 평가는?
- 사용자가 스스로 작성한 자신의 취향은?
- 사용자가 무엇을 클릭했는가?

이런 데이터를 기반으로 추천 시스템은 '당신만을 위한 최신 상품', '이 상품을 선택한 다른 사람들이 좋아하는 상품들', '이 상품을 좋아하나요?' 같은 문구로 사용자가 상품을 구매하도록 유혹합니다.

<br><br>

##### 추천 시스템의 유형

추천 시스템은 콘텐츠 기반 필터링(Content based filtering) 방식과 협업 필터링(Collaborative filtering) 방식으로 나뉩니다.

협업 필터링은 다시 최근접 이웃(Nearest Neighbor) 협업 필터링과 잠재 요인(Latent Factor) 협업 필터링으로 나뉩니다.

- 콘텐츠 기반 필터링
- 협업 필터링
  - 최근접 이웃 협업 필터링
  - 잠재 요인 협업 필터링



초창기에는 콘텐츠 기반 필터링이나 최근접 이웃 협업 필터링이 주로 사용됐지만, 넷플릭스 추천 시스템 경연 대회에서 행렬 분해(Matrix Factorization) 기법을 이용한 잠재 요인 협업 필터링 방식이 우승하면서 많은 온라인 스토어에서 잠재 요인 협업 필터링 기반의 추천 시스템을 적용하고 있습니다.

하지만 서비스 아이템의 특성에 따라 콘텐츠 기반 필터링이나 최근접 이웃 기반 필터링 방식을 유지하는 사이트들도 많고, 요즘에는 개인화 특성을 강화하기 위해 하이브리드 형식으로 결합해 사용하는 경우도 늘고 있습니다.

<br><br><br>

### 콘텐츠 기반 필터링 추천 시스템

콘텐츠 기반 필터링 방식은 사용자가 특정한 아이템을 매우 선호하는 경우, 그 아이템과 비슷한 콘텐츠를 가진 다른 아이템을 추천하는 방식입니다.

예를 들어 사용자가 '엔드게임'이라는 영화에 8점(10점 만점), '인피니티 워'에 9점이라는 높은 점수를 줬을 때,

'엔드게임'과 '인피니티 워'의 장르, 감독, 출연 배우, 키워드 등의 콘텐츠를 감안해 이와 유사한 영화를 추천합니다.

'엔드게임'의 경우 장르가 액션, 모험, 슈퍼히어로 영화이고, '인피니티 워'는 액션, 슈퍼히어로 영화, SF로 분류됩니다.

영화 감독의 경우 앤서니 루소, 조 루소입니다.

콘텐츠 기반 필터링 추천 시스템은 사용자가 높게 평가한 이러한 영화의 콘텐츠를 감안해 이와 적절하게 매칭되는 영화를 추천해줍니다.

'시빌 워'의 경우 사용자가 선호하는 감독, 장르 등의 콘텐츠를 다양하게 포함하고 있으므로 콘텐츠 기반 필터링 추천 시스템에 의해 추천되게 됩니다.

<img src="https://user-images.githubusercontent.com/76269316/131944660-f15b9b72-41f6-4e15-a4ca-02daacd590c2.png" alt="image" style="zoom:80%;" />

<br><br><br>

### 최근접 이웃 협업 필터링

하지만 좋아하는 배우/감독만을 보고 영화를 선택했다가 실망한 경험이 있을겁니다.

그래서 우리는 대부분 영화를 본 가까운 친구들(취향이 비슷한)에게 영화가 어땠는지를 물어보고 영화를 보러 갈지 말지를 결정합니다.

이렇게 친구들에게 물어보는 것과 유사한 방식으로, 사용자가 아이템에 매긴 평점 정보나 상품 구매 이력과 같은 사용자 행동 양식(User Behavior)만을 기반으로 추천을 수행하는 것이 협업 필터링(Collaborative Filtering) 방식입니다.



협업 필터링의 주요 목표는 사용자-아이템 평점 행렬과 같은 축적된 사용자 행동 데이터를 기반으로 사용자가 아직 평가하지 않은 아이템을 예측 평가(Predicted Rating) 하는 것입니다.



![image](https://user-images.githubusercontent.com/76269316/131945428-2ccd963c-db1f-4c34-aaf7-b730ba2e3e9e.png)

위 그림에서 User1은 Item 4에 대해 아직 평가하지 않았습니다.

협업 필터링은 사용자가 평가한 다른 아이템을 기반으로 사용자가 평가하지 않은 아이템의 예측 평가를 도출하는 방식입니다

