---
title:  "2.scikit-learn Machine Learning in Python"
excerpt: "사이킷런으로 시작하는 머신러닝"
toc: true
toc_label: "scikit-learn Machine Learning in Python"
toc_sticky: true

categories:
  - Machine Learning
tags:
  - Machine Learning
last_modified_at: 2021-06-25
---





>![파이썬 머신러닝 완벽 가이드](https://user-images.githubusercontent.com/76269316/122906446-1fa9c000-d38d-11eb-9cab-1eb7e347a1e6.png)
>
>파이썬 머신러닝 완벽 가이드를 읽고 공부한 내용을 정리한 포스팅입니다.



사이킷런(scikit-learn)은 파이썬 머신러닝 라이브러리 중 가장 많이 사용되는 라이브러리입니다.

사이킷런의 특징은 다음과 같습니다.

- 쉽고 가장 파이썬스러운 API를 제공
- 머신러닝을 위한 매우 다양한 알고리즘과 편리한 프레임워크, API를 제공
- 오랜 기간 실전 환경에서 검증되어 많은 환경에서 사용되는 성숙한 라이브러리임



Anaconda를 설치하면 기본으로 사이킷런까지 설치가 완료되기 때문에 별도로 설치할 필요가 없습니다.

+재설치 해야하는 경우 (conda 명령어로 설치하는 것을 권장)

```python
conda install scikit-learn  #Anaconda의 conda 명령어로 설치할 경우 사이킷런 구동에 필요한 다양한 라이브러리를 동시에 설치해줌
pip install scikit-learn
```



### 붓꽃 품종 예측하기

사이킷런에는 예제로 활용할 수 있는 간단한 데이터 세트가 내장돼 있습니다. 

이 중 하나인 붓꽃 데이터 세트를 이용해서 붓꽃 품종 예측 머신러닝 모델을 만들어보겠습니다.



붓꽃 품종 예측 머신러닝 모델이라는 것은 붓꽃 데이터 세트의 꽃잎의 길이와 너비, 꽃받침의 길이와 너비 feature를 기반으로 꽃의 품종을 분류(Classfication)한다는 것입니다.

분류(Classfication)는 대표적인 [지도학습](https://seominseok4834.github.io/1.machine-learning-term-and-concept/#supervised-learning) 방법 중 하나인데,

![image](https://user-images.githubusercontent.com/76269316/123435462-1dc64380-d5bd-11eb-940a-fdad9059c48f.png)

지도학습은 학습을 위한 다양한 피처와 분류 결정값인 레이블(Label) 데이터로 모델을 학습한 뒤, 별도의 테스트 데이터 세트에서 미지의 레이블을 예측합니다. (명확한 정답이 주어진 데이터를 먼저 학습한 뒤 미지의 정답을 예측하는 방식)

이 때, 학습을 위해 주어진 데이터 세트를 **학습 데이터 세트**, 머신러닝 모델의 예측 성능을 평가하기 위해 별도로 주어진 데이터 세트를 **테스트 데이터 세트**라고 합니다.



feature와 label이 뭔지 감이 안 오실텐데, feature는 단어 그대로 특징을 의미합니다. 

붓꽃 데이터 세트에서 feature는 꽃잎의 길이와 너비, 꽃받침의 길이와 너비를 의미합니다.

label도 마찬가지로 우리가 상표나 품명을 인쇄해서 붙여놓는 종잇조각인 라벨처럼, 각각의 데이터들이 무엇인지를 결정해주는 값입니다. 붓꽃 데이터 세트에서는 붓꽃의 품종(setosa, vesicolor, virginica)을 의미합니다.



즉, 학습 데이터 세트를 통해서 학습을 시킬 때는 각각의 feature들이 어떤 품종인지를 나타내는 label 값을 주고 학습을 시킨 다음, 실제로 학습시킨 머신 러닝 모델의 예측 성능을 평가할 때는 이 label값을 주지 않고 feature 값만 줌으로써 (이 때 주어지는 feature는 학습시킬 때의 feature와는 다른 값입니다.) label을 얼마나 잘 예측했는지를 평가합니다.



사이킷런의 여러 모듈들을 사용해서 실제로 붓꽃 품종 예측 머신러닝 모델을 만들어보겠습니다.

```python
import pandas as pd
import sklearn

from sklearn.datasets import load_iris  #sklearn.datasets : 사이킷런에서 자체적으로 제공하는 데이터 세트를 생성하는데 사용되는 모듈
from sklearn.tree import DecisionTreeClassifier  #sklearn.tree : 트리 기반 ML 알고리즘을 구현한 클래스의 모임
from sklearn.model_selection import train_test_split  #sklearn.model_selection : 학습 데이터와 검증데이터, 예측 데이터로 데이터를 분리하거나 최적의 하이퍼 파라미터로 평가하기 위한 모듈

#붓꽃 데이터 세트 로딩
iris = load_iris()

#iris.data는 데이터 세트에서 feature만으로 된 데이터를 numpy로 갖고 있음
iris_data = iris.data

#iris.target은 붓꽃 데이터 세트에서 label만으로 된 데이터를 numpy로 갖고 있음
iris_label = iris.target

#붓꽃 데이터 세트를 자세히 보기위해 DataFrame으로 변환
iris_df = pd.DataFrame(data=iris_data, columns=iris.feature_names)
iris_df['label'] = iris.target  #label column 추가
iris_df  #붓꽃 데이터 세트를 DataFrame으로 변환한 걸 출력
```

![image](https://user-images.githubusercontent.com/76269316/123438220-73294180-d60b-11eb-8f78-19524a19fd18.png)



아직 의사 결정 트리 (Decision Tree) 같은 주요 머신러닝 알고리즘에 대해 설명하지 않았지만 일단은 데이터를 학습하고 예측하는 머신러닝 기법을 구현한 주요 알고리즘 정도로 이해하면 될 것 같습니다.



한 줄 한 줄 살펴보면

```python
iris_data
print('iris_data type:', type(iris_data))
```

![image](https://user-images.githubusercontent.com/76269316/123442115-84744d00-d60f-11eb-8e1b-7fb212e80bab.png)



다음과 같이, iris_data는 feature 값(꽃잎의 길이와 너비, 꽃받침의 길이와 너비)을 저장한 numpy의 ndarray type이라는 것을 알 수 있습니다.



```python
iris_label
print('iris_label type:',type(iris_label))
print('iris target명:', iris.target_names)
```

![image](https://user-images.githubusercontent.com/76269316/123442355-c30a0780-d60f-11eb-8455-cf21b4902470.png)



iris_label 값을 보면 0, 1, 2로만 이루어진 것을 알 수 있는데, 이는 각각 setosa, versicolor, virginica 품종을 의미합니다.



```python
iris_df = pd.DataFrame(data=iris_data, columns=iris.feature_names)
iris_df
```

![image](https://user-images.githubusercontent.com/76269316/123442659-13816500-d610-11eb-826b-6d6f152f2202.png)



label 값을 추가하지 않고 dataframe으로 변환시 해당 feature가 어떤 품종인지 알 수 없습니다.



따라서 다음과 같이 label column을 추가해줌으로써 해당 feature가 어떤 품종인지 보여줍니다.

```python
iris_df['label'] = iris.target
iris_df
```

![image](https://user-images.githubusercontent.com/76269316/123442915-59d6c400-d610-11eb-8b65-c89cfbb47d36.png)
