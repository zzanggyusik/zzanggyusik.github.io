---
title:  "[Capstone] pyABSA Dataset"
excerpt: "pyABSA Dataset êµ¬ì¡° ë¶„ì„"
toc: true
toc_label: "pyABSA Dataset"
toc_sticky: true
published: true

categories:
  - Capstone
tags:
  - PyTorch
  - pyABSA
last_modified_at: 2022-05-21

---

ì´ì „ê¹Œì§€ ì—´ì‹¬íˆ ë¶„ì„í–ˆë˜ MAMS for ABSA ì½”ë“œì—ëŠ” term extraction ë¶€ë¶„ì´ ì—†ì—ˆë‹¤ ..

ì–´ì©ì§€ forward í•¨ìˆ˜ì— sentenceë‘ aspectê°€ ê°™ì´ ë“¤ì–´ê°€ë”ë¼ë‹ˆ ğŸ˜©

1í•™ê¸° ìµœì¢… ë°œí‘œë„ ì–¼ë§ˆ ì•ˆë‚¨ì•„ì„œ ë£° ë² ì´ìŠ¤ë¡œ ëŒ€ì¶© êµ¬í˜„í–ˆëŠ”ë° ì•„ì£¼ ë§ˆìŒì— ì•ˆ ë“¤ì–´ì„œ ê¹ƒí—ˆë¸Œë‘ papers with code ë’¤ì ì´ë‹¤ê°€ pyABSAë¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆì„ì›Œí¬ë¥¼ ë°œê²¬í–ˆë‹¤.

í•œêµ­ì–´ë¡œë„ í•  ìˆ˜ ìˆëƒê³  ë¬¼ì–´ë´¤ë”ë‹ˆ multilingualë¡œ í•œ ë²ˆ í•´ë³´ë¼ëŠ” ë‹µë³€ì´ ì™”ë‹¤.

<img width="919" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 8 08 11" src="https://user-images.githubusercontent.com/76269316/170593717-ec63c087-4e8e-497c-88e4-17d2a2ce47d1.png">

ë  ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ì¼ë‹¨ í”¼ë“œë°±ì´ ë§¤ìš° ë¹¨ë¼ì„œ í•œ ë²ˆ í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

<br>

<img width="1243" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 8 11 35" src="https://user-images.githubusercontent.com/76269316/170594016-71898130-378e-49dd-8e74-27e59269b979.png">

ì¼ë‹¨ ë°ì´í„°ì…‹ êµ¬ì„±ì´ ì¢€ ë‹¬ë¼ì„œ ë°ì´í„°ì…‹ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

<br>

ê·¸ë˜ì„œ ë°ì´í„°ì…‹ì„ ë´¤ë”ë‹ˆ B-ASP ??? I-ASP ???

```xml
Our O -999
agreed O -999
favorite O -999
is O -999
the O -999
orrechiete B-ASP Positive
with I-ASP Positive
sausage I-ASP Positive
and I-ASP Positive
chicken I-ASP Positive
- O -999
LRB O -999
- O -999
usually O -999
the O -999
waiters B-ASP -999
are O -999
kind O -999
enough O -999
to O -999
split O -999
the O -999
dish B-ASP -999
in O -999
half O -999
so O -999
you O -999
get O -999
to O -999
sample O -999
both O -999
meats B-ASP -999
- O -999
RRB O -999
- O -999
. O -999
```

ì²˜ìŒ ë³´ëŠ” ë‹¨ì–´ë“¤ì´ ìˆì–´ì„œ êµ¬ê¸€ë§ í•´ë´¤ë”ë‹ˆ

<img width="1580" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 8 14 02" src="https://user-images.githubusercontent.com/76269316/170594253-3488b20b-ce24-40a5-ad3c-0cb7ff42680b.png">

ì•„ë¬´ê²ƒë„ ì•ˆ ë‚˜ì˜¨ë‹¤.

<br>

ê·¸ë˜ì„œ ë˜ ë¬¼ì–´ë´¤ë‹¤.

<img width="914" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 8 15 13" src="https://user-images.githubusercontent.com/76269316/170594360-0840231a-c2b5-40ed-af8f-9b8c6523ee0e.png">

B-ASPê°€ ë­”ì§€ëŠ” ì•ˆ ì•Œë ¤ì¤˜ì„œ ë‹¤ì‹œ ë¬¼ì–´ë´¤ë”ë‹ˆ

<img width="914" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 8 15 53" src="https://user-images.githubusercontent.com/76269316/170594417-8100d2fb-7945-4ce7-8877-f85ca88167d1.png">

IOB annotationì´ë¼ëŠ” ë‹µë³€ì´ ëŒì•„ì™”ë‹¤. [Inside-outside-beginning Wikipedia](https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging))

ìê¾¸ ìƒˆë¡œìš´ ë­”ê°€ê°€ ë‚˜ì˜¨ë‹¤ ã… 

<br>

ì›ë˜ SemEval 2014 Restaurants ë°ì´í„°ì…‹ê³¼ pyABSA ë°ì´í„°ì…‹ì„ ë¹„êµí•˜ë©° ì–´ë–¤ ì‹ìœ¼ë¡œ ë³€í™˜í•´ì•¼ í•˜ëŠ”ì§€ ì‚´í´ë³´ê² ë‹¤.

ATEPC ë°ì´í„°ì…‹ê³¼ APC ë°ì´í„°ì…‹ìœ¼ë¡œ ë‚˜ë‰˜ëŠ”ë°, ATEPCëŠ” aspect term extraction(ATE)ê³¼ aspect polarity classification(APC)ë¥¼ í•©ì¹œ ê²ƒì´ë‹¤.

> LCF-ATEPC, a multi-task learning model for Chinese and multilingual-oriented ATE and APC task, based on PyTorch

<br>

### ATEPC Dataset

ë¨¼ì € ATEPCë¶€í„° ë³´ë©´,

[ABSADatasets/datasets/atepc_datasets/110.SemEval/114.restaurant14/Restaurants_Train.xml.seg.atepc](https://github.com/yangheng95/ABSADatasets/tree/v1.2/datasets/atepc_datasets/110.SemEval/114.restaurant14)

```xml
But O -999
the O -999
staff B-ASP Negative
was O -999
so O -999
horrible O -999
to O -999
us O -999
. O -999

The O -999
food B-ASP Positive
is O -999
uniformly O -999
exceptional O -999
, O -999
with O -999
a O -999
very O -999
capable O -999
kitchen B-ASP -999
which O -999
will O -999
proudly O -999
whip O -999
up O -999
whatever O -999
you O -999
feel O -999
like O -999
eating O -999
, O -999
whether O -999
it O -999
' O -999
s O -999
on O -999
the O -999
menu B-ASP -999
or O -999
not O -999
. O -999
```

ê°ê°ì˜ textê°€ í•œ ë¼ì¸ì„ ê¸°ì¤€ìœ¼ë¡œ êµ¬ë¶„ë¼ ìˆë‹¤.

'But the staff was so horrible to us.', 'The food is uniformly exceptional, with a very capable kitchen which will proudly whip up whatever you feel like eating, whether it's on the menu or not.'

ì›ë˜ SemEval ë°ì´í„°ì…‹ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë¼ ìˆë‹¤.

```xml
    <sentence id="3121">
        <text>But the staff was so horrible to us.</text>  <!-- ì²«ë²ˆì§¸ ë¬¸ì¥ -->
        <aspectTerms>
            <aspectTerm term="staff" polarity="negative" from="8" to="13"/>
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="service" polarity="negative"/>
        </aspectCategories>
    </sentence>
    <sentence id="1634">
        <text>The food is uniformly exceptional, with a very capable kitchen which will proudly whip up whatever you feel like eating, whether it's on the menu or not.</text>  <!-- ë‘ë²ˆì§¸ ë¬¸ì¥ -->
        <aspectTerms>
            <aspectTerm term="food" polarity="positive" from="4" to="8"/>
            <aspectTerm term="kitchen" polarity="positive" from="55" to="62"/>
            <aspectTerm term="menu" polarity="neutral" from="141" to="145"/>
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="food" polarity="positive"/>
        </aspectCategories>
    </sentence>
```

<br>

ì²«ë²ˆì§¸ ë¬¸ì¥ì„ ì‚´í´ë³´ë©´ staffë¼ëŠ” termì´ negativeë¡œ ë¼ë²¨ë§ ë¼ ìˆëŠ”ë° pyABSAì—ì„œëŠ” ì•„ë˜ì²˜ëŸ¼ ë³€í™˜í•œë‹¤.

```xml
    <sentence id="3121">
        <text>But the staff was so horrible to us.</text>
        <aspectTerms>
            <aspectTerm term="staff" polarity="negative" from="8" to="13"/>
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="service" polarity="negative"/>
        </aspectCategories>
    </sentence>
```

<br>

```xml
But O -999
the O -999
staff B-ASP Negative
was O -999
so O -999
horrible O -999
to O -999
us O -999
. O -999
```

termì´ ìˆëŠ” ë¶€ë¶„ì„ B-ASPë¡œ, ê·¹ì„±ì„ Negativeë¡œ ë¼ë²¨ë§ í–ˆë‹¤.

OëŠ” termì´ ì•„ë‹Œ í† í°ì„ í‘œì‹œí•˜ëŠ” IOB annotationì˜ íƒœê·¸ì´ê³ , -999ëŠ” ê·¹ì„±ì´ ì—†ëŠ” í† í°ì— ì±„ìš°ëŠ” íŒ¨ë”©ê°’ì´ë‹¤.

**ì¦‰ aspectTermìœ¼ë¡œ ë¼ë²¨ë§ëœ ë‹¨ì–´ì— ëŒ€í•´ì„œëŠ” B-ASP ê·¹ì„±ìœ¼ë¡œ ë¼ë²¨ë§í•œ ê²ƒì´ë‹¤.**

<br>

ë‘ë²ˆì§¸ ë¬¸ì¥ì²˜ëŸ¼ aspectTermì´ ì—¬ëŸ¬ ê°œì¸ ë‹¨ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¼ë²¨ë§í•œë‹¤.

termì— í•´ë‹¹í•˜ëŠ” ë‹¨ì–´ë“¤ì€ ëª¨ë‘ B-ASPë¡œ ë¼ë²¨ë§í•˜ê³ , í•˜ë‚˜ì˜ ë©ì–´ë¦¬ì—ë§Œ ê°ì„±ì„ ë¼ë²¨ë§í•œë‹¤.

ì²«ë²ˆì§¸ term foodì—ë§Œ ê°ì • ë¼ë²¨ë§

```xml
The O -999
food B-ASP Positive
is O -999
uniformly O -999
exceptional O -999
, O -999
with O -999
a O -999
very O -999
capable O -999
kitchen B-ASP -999
which O -999
will O -999
proudly O -999
whip O -999
up O -999
whatever O -999
you O -999
feel O -999
like O -999
eating O -999
, O -999
whether O -999
it O -999
' O -999
s O -999
on O -999
the O -999
menu B-ASP -999
or O -999
not O -999
. O -999
```

<br>

ë‘ë²ˆì§¸ term kitchenì—ë§Œ ë¼ë²¨ë§

```xml
The O -999
food B-ASP -999
is O -999
uniformly O -999
exceptional O -999
, O -999
with O -999
a O -999
very O -999
capable O -999
kitchen B-ASP Positive
which O -999
will O -999
proudly O -999
whip O -999
up O -999
whatever O -999
you O -999
feel O -999
like O -999
eating O -999
, O -999
whether O -999
it O -999
' O -999
s O -999
on O -999
the O -999
menu B-ASP -999
or O -999
not O -999
. O -999
```

<br>

ì„¸ë²ˆì§¸ term menuì—ë§Œ ë¼ë²¨ë§

```xml
The O -999
food B-ASP -999
is O -999
uniformly O -999
exceptional O -999
, O -999
with O -999
a O -999
very O -999
capable O -999
kitchen B-ASP -999
which O -999
will O -999
proudly O -999
whip O -999
up O -999
whatever O -999
you O -999
feel O -999
like O -999
eating O -999
, O -999
whether O -999
it O -999
' O -999
s O -999
on O -999
the O -999
menu B-ASP Neutral
or O -999
not O -999
. O -999
```

<br>

ë§Œì•½ termì´ ë‹¨ì–´ ì—¬ëŸ¬ ê°œë¡œ êµ¬ì„±ë¼ ìˆë‹¤ë©´ ì²«ë²ˆì§¸ ë‹¨ì–´ì—ë§Œ B-ASP íƒœê·¸ë¥¼ ë¶™ì´ê³  ì´í›„ì—ëŠ” I-ASP íƒœê·¸ë¥¼ ë¶™ì¸ë‹¤.

```xml
    <sentence id="3359">
        <text>The pizza is the best if you like thin crusted pizza.</text>
        <aspectTerms>
            <aspectTerm term="pizza" polarity="positive" from="4" to="9"/>
            <aspectTerm term="thin crusted pizza" polarity="neutral" from="34" to="52"/>  <!-- ì—¬ëŸ¬ ê°œì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ëœ term -->
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="food" polarity="positive"/>
        </aspectCategories>
    </sentence>
```

<br>

```xml
The O -999
pizza B-ASP Positive
is O -999
the O -999
best O -999
if O -999
you O -999
like O -999
thin B-ASP -999
crusted I-ASP -999
pizza I-ASP -999
. O -999

The O -999
pizza B-ASP -999
is O -999
the O -999
best O -999
if O -999
you O -999
like O -999
thin B-ASP Neutral
crusted I-ASP Neutral
pizza I-ASP Neutral
. O -999
```

ê°ì„±ì€ ëª¨ë“  IOB íƒœê·¸ ì˜†ì— ë¶™ì—¬ì¤€ë‹¤.

<br>

### APC Dataset

APC ë°ì´í„°ì…‹ì€ ê°„ë‹¨í•˜ë‹¤.

termì´ ìˆëŠ” ë¶€ë¶„ì„ $T$ë¡œ ë°”ê¿”ì£¼ê³  ë°‘ì— term, ê·¸ ë°‘ì— ê°ì„±ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```xml
    <sentence id="3121">
        <text>But the staff was so horrible to us.</text>
        <aspectTerms>
            <aspectTerm term="staff" polarity="negative" from="8" to="13"/>
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="service" polarity="negative"/>
        </aspectCategories>
    </sentence>
```

<br>

[ABSADatasets/datasets/apc_datasets/110.SemEval/114.restaurant14/Restaurants_Train.xml.seg](https://github.com/yangheng95/ABSADatasets/blob/v1.2/datasets/apc_datasets/110.SemEval/114.restaurant14/Restaurants_Train.xml.seg)

```xml
But the $T$ was so horrible to us .
staff
Negative
```

<br>

termì´ ì—¬ëŸ¬ ë‹¨ì–´ë¡œ êµ¬ì„±ë¼ ìˆì–´ë„ ë™ì¼í•˜ë‹¤.

```xml
    <sentence id="3359">
        <text>The pizza is the best if you like thin crusted pizza.</text>
        <aspectTerms>
            <aspectTerm term="pizza" polarity="positive" from="4" to="9"/>
            <aspectTerm term="thin crusted pizza" polarity="neutral" from="34" to="52"/>
        </aspectTerms>
        <aspectCategories>
            <aspectCategory category="food" polarity="positive"/>
        </aspectCategories>
    </sentence>
```

<br>

```xml
The $T$ is the best if you like thin crusted pizza .
pizza
Positive
The pizza is the best if you like $T$ .
thin crusted pizza
Neutral
```

<br>

### ì •ë¦¬

- ATEPC Dataset
  termì´ í•œ ë‹¨ì–´ì¸ ê²½ìš° â¡ï¸ B-ASP ê°ì„±
  termì´ ë‘ ë‹¨ì–´ ì´ìƒì¸ ê²½ìš° â¡ï¸ ì²«ë²ˆì§¸ ë‹¨ì–´ë§Œ B-ASP ê°ì„±, ë‘ë²ˆì§¸ ë‹¨ì–´ë¶€í„°ëŠ” I-ASP ê°ì„±
- APC Dataset
  term ë¶€ë¶„ì„ $T$ë¡œ ë°”ê¾¼ ë’¤ ë°‘ì— term, ê·¸ ë°‘ì— ê°ì„±

<br>

âœš annotation íˆ´ì„ ì œê³µí•œë‹¤. [ABSADatasets](https://github.com/yangheng95/ABSADatasets)

APCë¡œ ë¼ë²¨ë§í•˜ëŠ” íˆ´ì¸ë°, APCë¡œë§Œ ë¼ë²¨ë§í•´ë„ ATEPCë¡œ ë³€í™˜í•˜ëŠ” ë©”ì†Œë“œê°€ ìˆì–´ ì†ì‰½ê²Œ ë³€í™˜ì´ ê°€ëŠ¥í•˜ë‹¤.

ë¬¸ì œëŠ” APCë¡œ ë¼ë²¨ë§í•˜ëŠ” íˆ´ì´ í•œêµ­ì–´ê°€ ì•ˆë¼ì„œ ATEPCë¡œ ë³€í™˜í•˜ëŠ” ë©”ì†Œë“œê°€ ë™ì‘í• ì§€ ëª¨ë¥´ê² ë‹¤.

â–¶ï¸ ì—­ì‹œë‚˜ ë™ì‘í•˜ì§€ ì•Šì•„ì„œ ì§ì ‘ ì½”ë“œë¥¼ ì‘ì„±í•´ì„œ ë³€í™˜í–ˆë‹¤.

<img width="1624" alt="ìŠ¤í¬ë¦°ìƒ· 2022-05-27 ì˜¤ì „ 9 02 27" src="https://user-images.githubusercontent.com/76269316/170602947-5c3fdbec-cf30-408c-a66c-0e87ca3230f2.png">

<br>

### +

```python
import os

import findfile

from pyabsa.functional import ATEPCModelList
from pyabsa.functional import Trainer, ATEPCTrainer
from pyabsa.functional import ABSADatasetList
from pyabsa.functional import ATEPCConfigManager
from pyabsa.functional.dataset import DatasetItem
from transformers import BertModel, DistilBertModel

atepc_config = ATEPCConfigManager.get_atepc_config_multilingual()
atepc_config.pretrained_bert = 'monologg/kobert'
atepc_config.model = ATEPCModelList.FAST_LCF_ATEPC
dataset_path = '/home/seominseok/ABSADatasets/datasets/atepc_datasets/100.CustomDataset'

aspect_extractor = ATEPCTrainer(config=atepc_config,
                  dataset=dataset_path,
                  from_checkpoint='',  # set checkpoint to train on the checkpoint.
                  checkpoint_save_mode=1,
                  auto_device=True
                  ).load_trained_model()
```

ë‹¤ìŒê³¼ ê°™ì´ ë°”ê¿”ì£¼ê³  ì‹¤í–‰í•˜ë‹ˆ ì‹¤í–‰ì€ ëœë‹¤.

ê·¸ëŸ°ë° ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì˜ˆì¸¡í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê¸€ì ë‹¨ìœ„ë¡œ ì˜ˆì¸¡í•œë‹¤..

<img width="1394" alt="ìŠ¤í¬ë¦°ìƒ· 2022-06-03 ì˜¤í›„ 4 00 31" src="https://user-images.githubusercontent.com/76269316/171803950-20952e8f-68a4-4f2e-856e-a7f153e2b9e4.png">
