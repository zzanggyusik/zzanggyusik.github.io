---
title: "[ëŒ€í•™ì› ë©´ì ‘ ì¤€ë¹„] ML Sampling ì •ë¦¬"
excerpt: "ìƒ˜í”Œë§ ì •ë¦¬"
toc: true
toc_label: "ML Sampling ì •ë¦¬"
toc_sticky: true

categories:
  - MS
tags:
  - ëŒ€í•™ì›
last_modified_at: 2022-07-18
---

### Class Imbalance

í•™ìŠµ ë°ì´í„°ì˜ í´ë˜ìŠ¤ê°€ ê· ì¼í•˜ê²Œ ë¶„í¬í•˜ì§€ ì•Šê³ , í•˜ë‚˜ì˜ í´ë˜ìŠ¤ ê°’ì— ì¹˜ìš°ì³ í¸í•­ë˜ê²Œ í•™ìŠµë˜ëŠ” ê²ƒì„ **í´ë˜ìŠ¤ ë¶ˆê· í˜•(Class Imbalance)**ì´ë¼ê³  í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179516000-c87b1b27-0039-497e-b5f4-703e53c3b65f.png)

ìœ„ ì´ë¯¸ì§€ëŠ” ìºê¸€ [Credit Card Fraud Detection](https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud) ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ë¶„í¬ë¥¼ ì‹œê°í™”í•œ ê²ƒì…ë‹ˆë‹¤.

Not Fraudê°€ ì •ìƒì ì¸ ì‹ ìš©ì¹´ë“œ íŠ¸ëœì­ì…˜ ë°ì´í„°, Fraudê°€ ì‹ ìš©ì¹´ë“œ ì‚¬ê¸° íŠ¸ëœì­ì…˜ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì „ì²´ ë°ì´í„°ì˜ ì•½ 0.172%ë§Œì´ ì‚¬ê¸° íŠ¸ëœì­ì…˜ì…ë‹ˆë‹¤.

ì‚¬ê¸°ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ê°€ ì¼ë°˜ì ì´ì§„ ì•Šê¸° ë•Œë¬¸ì— ì´ë ‡ê²Œ ë¶ˆê· í˜•í•œ ë¶„í¬ë¥¼ ë„ê²Œ ë©ë‹ˆë‹¤.

ì‹¤ìƒí™œì—ì„œë„ ì´ì™€ ê°™ì´ ë¶ˆê· í˜•í•œ í´ë˜ìŠ¤ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„°ë“¤ì´ ë§ìŠµë‹ˆë‹¤. (ì•” ì˜ˆì¸¡, ìŠ¤íŒ¸ í•„í„°ë§ ë“±)

<br>

ì´ë ‡ê²Œ ë¶ˆê· í˜•í•œ ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµí•  ê²½ìš° ë‹¤ìˆ˜ í´ë˜ìŠ¤ë¡œ ì¹˜ìš°ì¹˜ê²Œ í•™ìŠµë¼ í¸í–¥ëœ ëª¨ë¸ì´ ë§Œë“¤ì–´ì§€ê²Œ ë©ë‹ˆë‹¤.

ê·¸ëŸ´ ê²½ìš° ëª¨ë¸ì´ ë‹¤ìˆ˜ í´ë˜ìŠ¤ë¡œ ì˜ˆì¸¡í•˜ëŠ” ê²½í–¥ì„±ì´ ë†’ì•„ì ¸ ì„±ëŠ¥ì´ ì™œê³¡ë˜ê²Œ ë©ë‹ˆë‹¤.

ğŸ‘‰  [Classification Metric](https://seominseok4834.github.io/ms/4.classification-metric-interview/) ì°¸ê³ 

<br>

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„  í´ë˜ìŠ¤ ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ Undersampling / Oversamplingì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.



![image](https://user-images.githubusercontent.com/76269316/179519114-baee0e95-096d-44ae-b945-804f30711b04.png)

- Undersampling: ë§ì€ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì ì€ ë°ì´í„° ì„¸íŠ¸ ìˆ˜ì¤€ìœ¼ë¡œ ê°ì†Œì‹œí‚¤ëŠ” ë°©ì‹

  ì •ìƒ ë ˆì´ë¸” ë°ì´í„°ê°€ 10,000ê±´, ì´ìƒ ë ˆì´ë¸”ì„ ê°€ì§„ ë°ì´í„°ê°€ 100ê±´ì´ ìˆìœ¼ë©´ ì •ìƒ ë ˆì´ë¸” ë°ì´í„°ë¥¼ 100ê±´ìœ¼ë¡œ ì¤„ì—¬ë²„ë¦¬ëŠ” ë°©ì‹

  ê³¼ë„í•˜ê²Œ ì •ìƒ ë ˆì´ë¸”ë¡œ í•™ìŠµ/ì˜ˆì¸¡í•˜ëŠ” ë¶€ì‘ìš©ì„ ê°œì„ í•  ìˆ˜ ìˆì§€ë§Œ, ë„ˆë¬´ ë§ì€ ì •ìƒ ë ˆì´ë¸” ë°ì´í„°ë¥¼ ê°ì†Œì‹œí‚¤ê¸° ë•Œë¬¸ì— ì •ìƒ ë ˆì´ë¸”ì˜ ê²½ìš° ì˜¤íˆë ¤ ì œëŒ€ë¡œ ëœ í•™ìŠµì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤ëŠ” ë‹¨ì ì´ ìˆì–´ ì˜ ì ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

- Oversampling : ì´ìƒ ë°ì´í„°ì™€ ê°™ì€ ì ì€ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì¦ì‹í•˜ì—¬ í•™ìŠµì„ ìœ„í•œ ì¶©ë¶„í•œ ë°ì´í„°ë¥¼ í™•ë³´í•˜ëŠ” ë°©ì‹

  ë™ì¼í•œ ë°ì´í„°ë¥¼ ë‹¨ìˆœíˆ ì¦ì‹ì‹œí‚¤ëŠ” ë°©ë²•ì€ ê³¼ì í•©ì´ ë˜ê¸° ë•Œë¬¸ì— ì›ë³¸ ë°ì´í„°ì˜ í”¼ì²˜ ê°’ë“¤ì„ ì•„ì£¼ ì•½ê°„ë§Œ ë³€ê²½í•˜ì—¬ ì¦ì‹

<br><br>

### Undersampling

##### Random Undersampling

ë‹¤ìˆ˜ í´ë˜ìŠ¤ì— ìˆëŠ” ê´€ì¸¡ì¹˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ìƒ˜í”Œë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ìˆ˜í–‰í•  ë•Œë§ˆë‹¤ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë„ì¶œë©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179521416-97a107f0-15a4-49f6-9038-23eab37f7f43.png)

ì¶œì²˜: [Machine learning prediction of susceptibility to visceral fat associated diseases](https://www.researchgate.net/publication/343326638_Machine_learning_prediction_of_susceptibility_to_visceral_fat_associated_diseases)

<br><br>

##### Tomek Links

![image](https://user-images.githubusercontent.com/76269316/179529457-6ff26fbb-2aab-4b6e-8a34-11e1d1500173.png)

ë‹¤ìˆ˜ í´ë˜ìŠ¤ì—ì„œ ì¶”ì¶œí•œ í¬ì¸íŠ¸ë¥¼ <img src="https://user-images.githubusercontent.com/76269316/179526117-a250b1a0-06f2-414c-b70b-9c87e2ce8050.png" alt="image" style="zoom:80%;" />, ì†Œìˆ˜ í´ë˜ìŠ¤ì— ì¶”ì¶œí•œ í¬ì¸íŠ¸ë¥¼ <img src="https://user-images.githubusercontent.com/76269316/179526328-7dc3726f-d21a-4f84-ad4b-7071147cafb0.png" alt="image" style="zoom:80%;" />ë¼ê³  í•  ë•Œ, <img src="https://user-images.githubusercontent.com/76269316/179526117-a250b1a0-06f2-414c-b70b-9c87e2ce8050.png" alt="image" style="zoom:80%;" />ì™€ <img src="https://user-images.githubusercontent.com/76269316/179526328-7dc3726f-d21a-4f84-ad4b-7071147cafb0.png" alt="image" style="zoom:80%;" /> ì‚¬ì´ì— ë” ê°€ê¹Œìš´ ë°ì´í„° <img src="https://user-images.githubusercontent.com/76269316/179526562-100a44c1-a1ee-447c-95fa-594703d7b7d7.png" alt="image" style="zoom:80%;" />ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë‘ ê´€ì¸¡ì¹˜ëŠ” Tomek linkê°€ ë˜ê²Œ ë©ë‹ˆë‹¤.

ì´ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179527927-d768dae1-0e67-4f65-92ce-8c14af593399.png)

<br>

![image](https://user-images.githubusercontent.com/76269316/179533429-d006826c-c0c9-46e6-b2ab-43294f0ff335.png)

ì´ë ‡ê²Œ Tomek linkë¥¼ í˜•ì„±í•œ ë‘ ìƒ˜í”Œ(ì´ˆë¡ìƒ‰ ë™ê·¸ë¼ë¯¸) ì¤‘ í•˜ë‚˜ëŠ” ë…¸ì´ì¦ˆì´ê±°ë‚˜, í´ë˜ìŠ¤ ê²½ê³„ì„  ê·¼ì²˜ì— ìˆìœ¼ë¯€ë¡œ ë‹¤ìˆ˜ í´ë˜ìŠ¤ì— ì†í•˜ëŠ” ìƒ˜í”Œë“¤ì„ ì œê±°í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179533296-2f790b3c-6293-4fbc-aabb-f7c63e6da540.png)

ì´ë ‡ê²Œ ë‹¤ìˆ˜ í´ë˜ìŠ¤ì— ì†í•˜ëŠ” ë°ì´í„°ë¥¼ ì œê±°í•¨ìœ¼ë¡œì¨ í´ë˜ìŠ¤ ê²½ê³„ì„ ì„ ë‹¤ìˆ˜ í´ë˜ìŠ¤ ìª½ìœ¼ë¡œ ë°€ì–´ë¶™ì´ëŠ” íš¨ê³¼ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤.

<br><br>

##### Condensed Nearest Neighbor

ë‹¤ìŒê³¼ ê°™ì€ ë°ì´í„°ê°€ ìˆë‹¤ê³  í•  ë•Œ,

![image](https://user-images.githubusercontent.com/76269316/179537121-7a21afea-4873-452c-bb2a-bfc1b8f7c04b.png)

<br>

![image](https://user-images.githubusercontent.com/76269316/179537204-a76c2b74-276e-4eaa-b09b-8b1a58c6146d.png)

ë¨¼ì € ì†Œìˆ˜ í´ë˜ìŠ¤ë¥¼ ëª¨ë‘ ì„œë¸Œ ë°ì´í„° ì§‘í•© S (ë¹¨ê°•ìƒ‰)ì— í¬í•¨ì‹œí‚µë‹ˆë‹¤.

<br>

![image](https://user-images.githubusercontent.com/76269316/179537567-58782b26-26e2-4a7d-a48c-a88d4440b9c0.png)

ì´í›„ ë‹¤ìˆ˜ í´ë˜ìŠ¤ì—ì„œ í•˜ë‚˜ì˜ ìƒ˜í”Œì„ ì¶”ì¶œí•œ ë’¤ ë‹¤ìˆ˜ í´ë˜ìŠ¤ì— ê°€ê¹Œìš°ë©´ ì§‘í•© Sì— í¬í•¨ì‹œí‚¤ì§€ ì•Šê³ , ì•„ë‹ˆë¼ë©´ ì§‘í•© Sì— í¬í•¨ì‹œí‚¨ë‹¤.

ì´ ê³¼ì •ì„ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ì„ íƒë˜ëŠ” ë°ì´í„°ê°€ ì—†ì„ ë•Œê¹Œì§€ ë°˜ë³µí•œë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179537815-ac3242b1-c2a6-4115-8519-3f9e28db0ec1.png)

<br>

ì´í›„ ì§‘í•© Sì— ì†í•œ ë°ì´í„°ë§Œ ë‚¨ê¸°ê³ , ë‚˜ë¨¸ì§€ëŠ” ì œê±°í•œë‹¤.

![image](https://user-images.githubusercontent.com/76269316/179538190-bb0ccf29-d5c3-4d6e-9270-5dc621db2ed8.png)

CNNì€ ì´ë ‡ê²Œ ì†Œìˆ˜ í´ë˜ìŠ¤ì— ê°€ê¹Œìš´ ë‹¤ìˆ˜ í´ë˜ìŠ¤ë¥¼ ì„ ë³„í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ ì œê±°í•¨ìœ¼ë¡œì¨ ë¶„ë¥˜ ê²½ê³„ì„ ì„ ì¬ì„¤ì •í•œë‹¤.

### Reference

- [[ì¸ì‚¬ì´ë“œ ë¨¸ì‹ ëŸ¬ë‹] ë¶ˆê· í˜• ë°ì´í„° ìƒ˜í”Œë§](https://velog.io/@cleansky/%EC%9D%B8%EC%82%AC%EC%9D%B4%EB%93%9C-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EB%B6%88%EA%B7%A0%ED%98%95-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%83%98%ED%94%8C%EB%A7%81)

- [ë¹„ëŒ€ì¹­ ë°ì´í„° ë¬¸ì œ](https://datascienceschool.net/03%20machine%20learning/14.02%20%EB%B9%84%EB%8C%80%EC%B9%AD%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%AC%B8%EC%A0%9C.html#id1)